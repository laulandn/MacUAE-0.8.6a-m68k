// System Utilities.c v1.0//// by Kenneth Worley// Public Domain//// Contact me at: America Online: KNEworley//		internet: KNEworley@aol.com or kworley@fascination.com///** changes made by !ZAJC!/GDS (Marin Saric) can be found	by searching for "!ZAJC!". The number after "!ZAJC!"	indicates day,month and year when the change was made**//* LNC-ddmmyy indicates changes on dd/mm/yy by Lars N¾sbye Christensen */#include "sysconfig.h"#include "mac.h"#include "System Utilities.h"#include <string.h>#include <Fonts.h> /* !ZAJC! 090798 */#include <Gestalt.h> /* LNC-251198 */#define MTopLeft(r)				(* (Point*) &(r.top) )void InitToolbox( void ){	/* Initialize the Mac Toolbox Managers */		InitGraf((Ptr) &qd.thePort);	InitFonts();	InitWindows();	InitMenus();	FlushEvents(everyEvent,0);	TEInit();	InitDialogs(0L);	InitCursor();}#if 0 // out of dateshort	GetSysVersion( void ){	SysEnvRec		env;		SysEnvirons( 2, &env );		if ( env.systemVersion >= 0x0700 )		return 7;	else if ( env.systemVersion >= 0x0600 )		return 6;	else		return 0;}#else/* LNC-251198 - rewrote GetSysVersion*/short	GetSysVersion( void ){long sysvers;Gestalt(gestaltSystemVersion, &sysvers);	if ( sysvers >= 0x0700 )		return 7;	else if ( sysvers >= 0x0600 )		return 6;	else		return 0;}#endifBoolean HasColorQuickDraw( void ){	SysEnvRec		env;		SysEnvirons( 2, &env );		return env.hasColorQD;}GDHandle WindowDevice( WindowPtr winPtr ){	GDHandle		theDevice;	Point			targetPt;		targetPt = MTopLeft( ((WindowPeek)winPtr)->port.portRect );		theDevice = GetDeviceList();	while ( !PtInRect( targetPt, &((**theDevice).gdRect) ) )	{		theDevice = GetNextDevice( theDevice );		if ( theDevice == NULL )		{			theDevice = GetMainDevice();			break;		}	}		return theDevice;}short IsDAWindow_( WindowPtr w ){    if( w == 0L )        return( false );    else /* DA windows have negative windowKinds */        return( ( (WindowPeek)w )->windowKind < 0 );}// Stolen from vicevoid GetFullPath(long DirID,short vRefnum,char *fileName,char *result)	{		CInfoPBRec myPB;		char dirName[256];		char fullPath[256];		char temp[256];		OSErr myErr;				strcpy(fullPath,"");		myPB.dirInfo.ioNamePtr=(unsigned char *) dirName;		myPB.dirInfo.ioVRefNum=vRefnum;		myPB.dirInfo.ioDrParID=DirID;		myPB.dirInfo.ioFDirIndex=-1;		do			{				myPB.dirInfo.ioDrDirID=myPB.dirInfo.ioDrParID;				myErr=PBGetCatInfo(&myPB,false);				strcpy(temp,fullPath);				sprintf(fullPath,"%.*s:",dirName[0],&dirName[1]);				strcat(fullPath,temp);			}		while(myPB.dirInfo.ioDrDirID!=fsRtDirID);		sprintf(&fullPath[strlen(fullPath)],"%.*s",fileName[0],&fileName[1]);		strcpy(result,fullPath);	}
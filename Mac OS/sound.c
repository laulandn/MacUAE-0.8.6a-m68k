 /*   * UAE - The Un*x Amiga Emulator  *   * Support for MacOS sound  *   * Copyright 1997 Bernd Schmidt  *///#include <Sound.h>#include "sysconfig.h"#include "sysdeps.h"#include "config.h"#include "options.h"#include "memory.h"#include "custom.h"#include "audio.h"#include "gensound.h"#include "sounddep/sound.h"#include "events.h"#include "AsgardESS.h"//#ifndef DONT_WANT_SOUNDuae_u16 sndbuffer[44100];uae_u16 *sndbufpt;int sndbufsize;extern int outpout_sound;int init_sound (void){	OSErr MyErr;	sndbufsize=currprefs.sound_maxbsiz;	    sample_evtime = (long)maxhpos * maxvpos * 50 / currprefs.sound_freq;    if (currprefs.sound_bits == 16) {		init_sound_table16 ();		sample_handler = currprefs.stereo ? sample16s_handler : sample16_handler;    } else {		init_sound_table8 ();		sample_handler = currprefs.stereo ? sample8s_handler : sample8_handler;	}		MyErr=AsgardESS_Init (	currprefs.sound_freq	// long frequency							,0x1					// int voices							,0x0					// Boolean sixteenBit/* ??? */					,0x0					// Boolean interpolate							,0x0					// Boolean normalized							,AESS_MIXER_LINEAR		// int Mixer							,AESS_STANDARD_GAIN/2	// in gain						);	sndbufpt = sndbuffer ;#if 1		{		AsgardESS_PlaySample( 0								// int voice,							,(unsigned char  *)sndbuffer	// unsigned char *pData,							,currprefs.sound_maxbsiz		// long length,							,currprefs.sound_freq			// long frequency,							,AESS_MAXIMUM_VOLUME			// int volume,							,0x1							// Boolean loop)							);	}#endif		if (MyErr) {		write_log(" Sound PROBLEM in init_sound\n");   		sound_available = 0;   		return 0;   	} else {		write_log ("Sound driver found and configured for %d bits at %d Hz, buffer is %d bytes\n",		currprefs.sound_bits, currprefs.sound_freq, currprefs.sound_maxbsiz);		sound_available = 1;		return 1;   	}//#ifdef FRAME_RATE_HACK//    vsynctime = vsynctime * 9 / 10;//#endif	}int setup_sound (void){	sound_available = 1;    return 1;}void close_sound(void){	if(sound_available) {			AsgardESS_Term();		sound_available = 0;		}}/*#elsevoid toggle_sound(void){}int init_sound (void){    currprefs.produce_sound = 0;    return 1;}int setup_sound (void){    currprefs.produce_sound = 0;    return 1;}void close_sound(void){}#endif*/